---
# Kubernetes Cluster Overview Dashboard
# SRE Entry Point: "Is my cluster healthy? Where should I look?"
dashboards:
  - id: k8s-cluster-overview
    name: '[Metrics K8s Cluster] Overview'
    description: High-level Kubernetes cluster health for rapid SRE triage
    controls:
      - type: options
        label: Namespace
        data_view: metrics-*
        field: k8s.namespace.name
    filters:
      - field: data_stream.dataset
        equals: kubernetesclusterreceiver.otel
    panels:
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # NAVIGATION
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - title: Navigation
        size: {w: 48, h: 3}
        links:
          layout: horizontal
          items:
            - label: ðŸ“Š Overview
              dashboard: k8s-cluster-overview
            - label: âš™ï¸ Workloads
              dashboard: k8s-cluster-workloads
            - label: ðŸ“¦ Resources
              dashboard: k8s-cluster-resources
            - label: ðŸ”„ Batch Jobs
              dashboard: k8s-cluster-batch
            - label: ðŸ“ˆ Autoscaling
              dashboard: k8s-cluster-hpa

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # CLUSTER HEALTH SUMMARY (4 metric cards - at-a-glance health)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - title: Cluster Health
        size: {w: 48, h: 3}
        markdown:
          content: '## ðŸ¥ Cluster Health'
          font_size: 14
      - title: Running Pods
        description: Pods in Running phase (phase=2).
        hide_title: true
        size: {w: 12, h: 4}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            formula: unique_count(k8s.pod.name)
            label: Running
          filters:
            - field: k8s.pod.phase
              equals: '2'
      - title: Pending Pods
        description: >-
          Pods in Pending phase (phase=1), waiting for scheduling or container
          image pull.
        hide_title: true
        size: {w: 12, h: 4}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            formula: unique_count(k8s.pod.name)
            label: Pending
          filters:
            - field: k8s.pod.phase
              equals: '1'
      - title: Failed Pods
        description: Pods in Failed phase (phase=4). Check pod logs for root cause.
        hide_title: true
        size: {w: 12, h: 4}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            formula: unique_count(k8s.pod.name)
            label: Failed
          filters:
            - field: k8s.pod.phase
              equals: '4'
      - title: Container Restarts
        hide_title: true
        size: {w: 12, h: 4}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            formula: sum(k8s.container.restarts)
            label: Restarts
          filters:
            - exists: k8s.container.restarts

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # ANALYSIS: Pod Health Distribution & Trends
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - title: Pod Health Distribution
        size: {w: 20, h: 14}
        lens:
          type: pie
          data_view: metrics-*
          dimensions:
            - field: k8s.pod.phase
              type: values
              label: Status
              size: 5
          metrics:
            - aggregation: unique_count
              field: k8s.pod.name
              label: Pods
          color:
            palette: eui_amsterdam_color_blind
            assignments:
              - value: '1'
                color: '#FEC514'
              - value: '2'
                color: '#54B399'
              - value: '3'
                color: '#6092C0'
              - value: '4'
                color: '#D36086'
              - value: '5'
                color: '#9170B8'
      - title: Pod Health Over Time
        size: {w: 28, h: 14}
        lens:
          type: area
          mode: stacked
          data_view: metrics-*
          dimension:
            field: '@timestamp'
            type: date_histogram
          breakdown:
            field: k8s.pod.phase
            type: values
            size: 5
          metrics:
            - aggregation: unique_count
              field: k8s.pod.name
              label: Pods
          color:
            palette: eui_amsterdam_color_blind
            assignments:
              - value: '1'
                color: '#FEC514'
              - value: '2'
                color: '#54B399'
              - value: '3'
                color: '#6092C0'
              - value: '4'
                color: '#D36086'
              - value: '5'
                color: '#9170B8'

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # WORKLOAD HEALTH PREVIEW
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - title: Workload Health
        size: {w: 48, h: 3}
        markdown:
          content: '## ðŸš€ Workload Health Preview'
          font_size: 14
      - title: Deployments - Desired vs Available
        description: >-
          Gap between lines indicates deployments that can't reach desired
          replica count.
        size: {w: 24, h: 12}
        lens:
          type: line
          data_view: metrics-*
          dimension:
            field: '@timestamp'
            type: date_histogram
          metrics:
            - formula: sum(k8s.deployment.desired)
              label: Desired
            - formula: sum(k8s.deployment.available)
              label: Available
          filters:
            - exists: k8s.deployment.name
      - title: Container Restarts by Namespace
        size: {w: 24, h: 12}
        lens:
          type: bar
          data_view: metrics-*
          dimension:
            field: k8s.namespace.name
            type: values
            size: 10
            sort:
              by: Restarts
              direction: desc
          metrics:
            - formula: sum(k8s.container.restarts)
              label: Restarts
          filters:
            - exists: k8s.container.restarts

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # DETAIL: Unhealthy Deployments Table
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - title: Unhealthy Deployments
        size: {w: 48, h: 3}
        markdown:
          content: '## ðŸ” Unhealthy Deployments (Desired â‰  Available)'
          font_size: 14
      - title: Deployments Missing Replicas
        description: >-
          Missing = Desired - Available. Positive values indicate failed
          provisioning or insufficient resources.
        size: {w: 48, h: 12}
        lens:
          type: datatable
          data_view: metrics-*
          dimensions:
            - field: k8s.deployment.name
              type: values
              size: 25
              label: Deployment
              sort:
                by: Missing
                direction: desc
            - field: k8s.namespace.name
              type: values
              size: 1
              label: Namespace
          metrics:
            - field: k8s.deployment.desired
              aggregation: max
              label: Desired
            - field: k8s.deployment.available
              aggregation: max
              label: Available
            - formula: max(k8s.deployment.desired) - max(k8s.deployment.available)
              label: Missing
          filters:
            - exists: k8s.deployment.name

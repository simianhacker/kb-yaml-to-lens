---
dashboards:
  - id: crowdstrike-modern-compliance-0d1e2f3a-4b5c-6d7e-8f9a-0b1c2d3e4f5a
    name: '[CrowdStrike Modern] Compliance & Audit'
    description: Compliance monitoring and audit trail dashboard for security event tracking, user activity analysis, access patterns, and regulatory
      reporting requirements.
    filters:
      - or:
          - field: data_stream.dataset
            equals: crowdstrike.alert
          - field: data_stream.dataset
            equals: crowdstrike.falcon
          - field: data_stream.dataset
            equals: crowdstrike.fdr
    controls:
      - type: options
        label: Event Action
        data_view: logs-*
        field: event.action
        match_technique: contains
      - type: options
        label: Event Category
        data_view: logs-*
        field: event.category
        match_technique: exact
      - type: options
        label: User
        width: small
        data_view: logs-*
        field: user.name
        match_technique: contains
    panels:
      # Context Layer - Navigation
      - title: Dashboard Navigation
        size:
          w: 48
          h: 4
        links:
          layout: horizontal
          items:
            - label: SOC Dashboard
              dashboard: crowdstrike-modern-soc-7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d
            - label: Threat Investigation
              dashboard: crowdstrike-modern-investigation-8b9c0d1e-2f3a-4b5c-6d7e-8f9a0b1c2d3e
            - label: Asset & Vulnerability
              dashboard: crowdstrike-modern-assets-9c0d1e2f-3a4b-5c6d-7e8f-9a0b1c2d3e4f
            - label: Compliance & Audit
              dashboard: crowdstrike-modern-compliance-0d1e2f3a-4b5c-6d7e-8f9a-0b1c2d3e4f5a

      # Analysis Layer - Audit Events Over Time
      - title: Security Audit Events Over Time
        description: Time series of security events for compliance reporting and trend analysis
        size:
          w: 48
          h: 15
        lens:
          type: area
          data_view: logs-*
          dimension:
            field: '@timestamp'
            type: date_histogram
            label: Time
          breakdown:
            field: event.kind
            type: values
            size: 5
            sort:
              by: Event Count
              direction: desc
          metrics:
            - aggregation: count
              label: Event Count

      # Analysis Layer - Event Categories
      - title: Event Category Distribution
        description: Security event types for compliance categorization
        size:
          w: 16
          h: 15
        lens:
          type: pie
          data_view: logs-*
          appearance:
            donut: medium
          dimensions:
            - field: event.category
              type: values
              size: 10
              sort:
                by: Count
                direction: desc
          metrics:
            - aggregation: count
              label: Count

      # Analysis Layer - Event Kinds
      - title: Event Kind Distribution
        description: Event classification for audit trail completeness
        size:
          w: 16
          h: 15
        lens:
          type: pie
          data_view: logs-*
          appearance:
            donut: medium
          dimensions:
            - field: event.kind
              type: values
              size: 8
              sort:
                by: Count
                direction: desc
          metrics:
            - aggregation: count
              label: Count

      # Analysis Layer - FDR Event Categories
      - title: FDR Event Categories
        description: Flight Data Recorder event types for detailed system activity
        size:
          w: 16
          h: 15
        lens:
          type: pie
          data_view: logs-*
          appearance:
            donut: medium
          dimensions:
            - field: crowdstrike.event.Category
              type: values
              size: 10
              sort:
                by: Count
                direction: desc
          metrics:
            - aggregation: count
              label: Count
          filters:
            - field: data_stream.dataset
              equals: crowdstrike.fdr

      # Analysis Layer - Alert Status for Compliance
      - title: Alert Response Status
        description: Alert handling status for incident response compliance
        size:
          w: 16
          h: 15
        lens:
          type: pie
          data_view: logs-*
          appearance:
            donut: medium
          dimensions:
            - field: crowdstrike.alert.status
              type: values
              size: 8
              sort:
                by: Count
                direction: desc
          metrics:
            - aggregation: count
              label: Count
          filters:
            - field: data_stream.dataset
              equals: crowdstrike.alert

      # Analysis Layer - Falcon Status
      - title: Falcon Event Status
        description: Detection status tracking for compliance reporting
        size:
          w: 16
          h: 15
        lens:
          type: pie
          data_view: logs-*
          appearance:
            donut: medium
          dimensions:
            - field: crowdstrike.event.Status
              type: values
              size: 8
              sort:
                by: Count
                direction: desc
          metrics:
            - aggregation: count
              label: Count
          filters:
            - field: data_stream.dataset
              equals: crowdstrike.falcon

      # Analysis Layer - Platform Coverage
      - title: Platform Coverage
        description: OS platform distribution for compliance scope verification
        size:
          w: 16
          h: 15
        lens:
          type: pie
          data_view: logs-*
          appearance:
            donut: medium
          dimensions:
            - field: host.os.platform
              type: values
              size: 8
              sort:
                by: Count
                direction: desc
          metrics:
            - aggregation: count
              label: Count

      # Detail Layer - Top Event Actions
      - title: Top 10 Event Actions
        description: Most frequent security actions for audit trail analysis
        size:
          w: 24
          h: 15
        lens:
          type: bar
          data_view: logs-*
          dimension:
            field: event.action
            type: values
            size: 10
            sort:
              by: Action Count
              direction: desc
            other_bucket: false
          metrics:
            - aggregation: count
              label: Action Count

      # Detail Layer - Top Users
      - title: Top 10 Users by Activity
        description: User activity levels for access pattern analysis
        size:
          w: 24
          h: 15
        lens:
          type: bar
          data_view: logs-*
          dimension:
            field: user.name
            type: values
            size: 10
            sort:
              by: Event Count
              direction: desc
            other_bucket: false
          metrics:
            - aggregation: count
              label: Event Count

      # Detail Layer - Most Active Hosts
      - title: Top 10 Most Active Hosts
        description: Host activity for system usage and coverage verification
        size:
          w: 24
          h: 15
        lens:
          type: bar
          data_view: logs-*
          dimension:
            field: host.name
            type: values
            size: 10
            sort:
              by: Event Count
              direction: desc
            other_bucket: false
          metrics:
            - aggregation: count
              label: Event Count

      # Detail Layer - Device Activity
      - title: Top 10 Devices by Event Volume
        description: Device identifiers for endpoint compliance tracking
        size:
          w: 24
          h: 15
        lens:
          type: bar
          data_view: logs-*
          dimension:
            field: device.id
            type: values
            size: 10
            sort:
              by: Event Count
              direction: desc
            other_bucket: false
          metrics:
            - aggregation: count
              label: Event Count
          filters:
            - exists: device.id

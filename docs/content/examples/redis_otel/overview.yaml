---
dashboards:
  - name: '[Metrics Redis] Overview'
    description: OpenTelemetry Redis Receiver - Overview dashboard showing key metrics across all Redis instances
    filters:
      - field: data_stream.dataset
        equals: redisreceiver.otel
    panels:
      - position: {x: 0, y: 0}
        size: {w: 48, h: 2}
        links:
          layout: horizontal
          items:
            - label: Overview
              dashboard: redis-overview
            - label: Instance Details
              dashboard: redis-instance-details
            - label: Database Metrics
              dashboard: redis-database-metrics
            - label: Redis Documentation
              url: https://redis.io/docs/
      - position: {x: 0, y: 2}
        size: {w: 48, h: 2}
        markdown:
          content: '## Redis Instance Overview'
          font_size: 14
      - title: Total Redis Instances
        position: {x: 0, y: 4}
        size: {w: 8, h: 4}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            aggregation: unique_count
            field: resource.attributes.service.instance.id
            label: Instances
      - title: Total Client Connections
        position: {x: 8, y: 4}
        size: {w: 8, h: 4}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            aggregation: sum
            field: redis.clients.connected
            label: Clients
      - title: Total Commands/sec
        position: {x: 16, y: 4}
        size: {w: 8, h: 4}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            aggregation: sum
            field: redis.commands
            label: Commands/sec
            format:
              type: number
      - title: Cache Hit Rate
        position: {x: 24, y: 4}
        size: {w: 8, h: 4}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            formula: average(redis.keyspace.hits) / (average(redis.keyspace.hits) + average(redis.keyspace.misses))
            label: Hit Rate
            format:
              type: percent
      - title: Total Memory Usage
        position: {x: 32, y: 4}
        size: {w: 8, h: 4}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            aggregation: sum
            field: redis.memory.used
            label: Memory
            format:
              type: bytes
      - title: Avg Memory Fragmentation
        position: {x: 40, y: 4}
        size: {w: 8, h: 4}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            aggregation: average
            field: redis.memory.fragmentation_ratio
            label: Fragmentation
            format:
              type: number
      - position: {x: 0, y: 8}
        size: {w: 48, h: 2}
        markdown:
          content: '## Memory & Performance Trends'
          font_size: 14
      - title: Memory Usage by Instance
        position: {x: 0, y: 10}
        size: {w: 24, h: 12}
        lens:
          type: area
          mode: stacked
          data_view: metrics-*
          legend:
            visible: show
            position: right
          dimension:
            field: '@timestamp'
            type: date_histogram
            label: Time
          breakdown:
            field: resource.attributes.service.instance.id
            type: values
            size: 20
            sort:
              by: Memory Used
              direction: desc
            other_bucket: true
            missing_bucket: false
          metrics:
            - aggregation: average
              field: redis.memory.used
              label: Memory Used
              format:
                type: bytes
      - title: Commands Per Second
        position: {x: 24, y: 10}
        size: {w: 24, h: 12}
        lens:
          type: line
          data_view: metrics-*
          legend:
            visible: show
            position: right
          dimension:
            field: '@timestamp'
            type: date_histogram
            label: Time
          breakdown:
            field: resource.attributes.service.instance.id
            type: values
            size: 20
            sort:
              by: Commands
              direction: desc
            other_bucket: true
            missing_bucket: false
          metrics:
            - aggregation: average
              field: redis.commands
              label: Commands
              format:
                type: number
      - title: Client Connections Over Time
        position: {x: 0, y: 22}
        size: {w: 24, h: 12}
        lens:
          type: line
          data_view: metrics-*
          legend:
            visible: show
            position: right
          dimension:
            field: '@timestamp'
            type: date_histogram
            label: Time
          breakdown:
            field: resource.attributes.service.instance.id
            type: values
            size: 20
            sort:
              by: Connected Clients
              direction: desc
            other_bucket: true
            missing_bucket: false
          metrics:
            - aggregation: average
              field: redis.clients.connected
              label: Connected Clients
              format:
                type: number
      - title: Keyspace Hit/Miss Rate
        position: {x: 24, y: 22}
        size: {w: 24, h: 12}
        lens:
          type: area
          mode: stacked
          data_view: metrics-*
          legend:
            visible: show
            position: right
          dimension:
            field: '@timestamp'
            type: date_histogram
            label: Time
          metrics:
            - formula: counter_rate(max(redis.keyspace.hits))
              label: Hit Rate
              format:
                type: number
            - formula: counter_rate(max(redis.keyspace.misses))
              label: Miss Rate
              format:
                type: number
      - position: {x: 0, y: 34}
        size: {w: 48, h: 2}
        markdown:
          content: '## Key Eviction & Expiration'
          font_size: 14
      - title: Keys Evicted Rate
        position: {x: 0, y: 36}
        size: {w: 24, h: 12}
        lens:
          type: line
          data_view: metrics-*
          legend:
            visible: show
            position: right
          dimension:
            field: '@timestamp'
            type: date_histogram
            label: Time
          breakdown:
            field: resource.attributes.service.instance.id
            type: values
            size: 20
            sort:
              by: Evicted
              direction: desc
            other_bucket: true
            missing_bucket: false
          metrics:
            - formula: counter_rate(max(redis.keys.evicted))
              label: Evicted
              format:
                type: number
      - title: Keys Expired Rate
        position: {x: 24, y: 36}
        size: {w: 24, h: 12}
        lens:
          type: line
          data_view: metrics-*
          legend:
            visible: show
            position: right
          dimension:
            field: '@timestamp'
            type: date_histogram
            label: Time
          breakdown:
            field: resource.attributes.service.instance.id
            type: values
            size: 20
            sort:
              by: Expired
              direction: desc
            other_bucket: true
            missing_bucket: false
          metrics:
            - formula: counter_rate(max(redis.keys.expired))
              label: Expired
              format:
                type: number
      - position: {x: 0, y: 48}
        size: {w: 48, h: 2}
        markdown:
          content: '## Network I/O'
          font_size: 14
      - title: Network Input (Bytes Received)
        position: {x: 0, y: 50}
        size: {w: 24, h: 12}
        lens:
          type: area
          mode: stacked
          data_view: metrics-*
          legend:
            visible: show
            position: right
          dimension:
            field: '@timestamp'
            type: date_histogram
            label: Time
          breakdown:
            field: resource.attributes.service.instance.id
            type: values
            size: 20
            sort:
              by: Input
              direction: desc
            other_bucket: true
            missing_bucket: false
          metrics:
            - formula: counter_rate(max(redis.net.input))
              label: Input
              format:
                type: bytes
      - title: Network Output (Bytes Sent)
        position: {x: 24, y: 50}
        size: {w: 24, h: 12}
        lens:
          type: area
          mode: stacked
          data_view: metrics-*
          legend:
            visible: show
            position: right
          dimension:
            field: '@timestamp'
            type: date_histogram
            label: Time
          breakdown:
            field: resource.attributes.service.instance.id
            type: values
            size: 20
            sort:
              by: Output
              direction: desc
            other_bucket: true
            missing_bucket: false
          metrics:
            - formula: counter_rate(max(redis.net.output))
              label: Output
              format:
                type: bytes
      - position: {x: 0, y: 62}
        size: {w: 48, h: 2}
        markdown:
          content: '## Instance Summary Table'
          font_size: 14
      - title: Redis Instance Metrics Summary
        position: {x: 0, y: 64}
        size: {w: 48, h: 25}
        lens:
          type: datatable
          data_view: metrics-*
          dimensions:
            - id: instance
              type: values
              field: resource.attributes.service.instance.id
              label: Instance
              size: 100
          metrics:
            - id: memory-used
              aggregation: average
              field: redis.memory.used
              label: Memory Used
              format:
                type: bytes
            - id: clients
              aggregation: average
              field: redis.clients.connected
              label: Clients
              format:
                type: number
            - id: commands
              aggregation: average
              field: redis.commands
              label: Cmd/sec
              format:
                type: number
            - id: hit-rate
              formula: average(redis.keyspace.hits) / (average(redis.keyspace.hits) + average(redis.keyspace.misses))
              label: Hit Rate
              format:
                type: percent
            - id: fragmentation
              aggregation: average
              field: redis.memory.fragmentation_ratio
              label: Fragmentation
              format:
                type: number
            - id: uptime
              aggregation: max
              field: redis.uptime
              label: Uptime (s)
              format:
                type: number
          paging:
            enabled: true
            page_size: 20

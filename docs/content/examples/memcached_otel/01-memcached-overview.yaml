---
dashboards:
  - id: memcached-otel-overview
    name: '[Metrics Memcached] Overview'
    description: Memcached monitoring dashboard for OpenTelemetry memcachedreceiver
    controls:
      - type: options
        label: Host Name
        data_view: metrics-*
        field: resource.attributes.host.name
    filters:
      - field: data_stream.dataset
        equals: memcachedreceiver.otel
    panels:
      - title: Overview
        position: {x: 0, y: 0}
        size: {w: 48, h: 3}
        markdown:
          content: |
            ## Memcached Monitoring Dashboard
            This dashboard provides comprehensive monitoring for Memcached instances using the OpenTelemetry Collector's `memcachedreceiver`.
            **Data Source:** Memcached `stats` command via OTel Collector
          font_size: 12
      - title: Current Items
        position: {x: 0, y: 3}
        size: {w: 8, h: 6}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            aggregation: last_value
            field: metrics.memcached.current_items
            label: Items in Cache
            format:
              type: number
      - title: Storage Used
        position: {x: 8, y: 3}
        size: {w: 8, h: 6}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            aggregation: last_value
            field: metrics.memcached.bytes
            label: Bytes Used
            format:
              type: bytes
      - title: Current Connections
        position: {x: 16, y: 3}
        size: {w: 8, h: 6}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            aggregation: last_value
            field: metrics.memcached.connections.current
            label: Active Connections
            format:
              type: number
      - title: Threads
        position: {x: 24, y: 3}
        size: {w: 8, h: 6}
        lens:
          type: metric
          data_view: metrics-*
          primary:
            aggregation: last_value
            field: metrics.memcached.threads
            label: Threads
            format:
              type: number
      - title: Average Hit Ratio
        position: {x: 32, y: 3}
        size: {w: 16, h: 6}
        lens:
          type: metric
          data_view: metrics-*
          breakdown:
            field: attributes.operation
            label: Operation
            size: 10
          primary:
            aggregation: average
            field: metrics.memcached.operation_hit_ratio
            label: Hit Ratio
            format:
              type: percent
      - title: Performance
        position: {x: 0, y: 9}
        size: {w: 48, h: 3}
        markdown:
          content: |
            ### Performance Metrics
            Hit ratios and operation counts for cache effectiveness monitoring.
          font_size: 12
      - title: Hit Ratio Over Time
        position: {x: 0, y: 12}
        size: {w: 24, h: 10}
        lens:
          type: line
          data_view: metrics-*
          legend:
            visible: show
            position: right
          dimension:
            field: '@timestamp'
            type: date_histogram
          breakdown:
            field: attributes.operation
            type: values
            size: 10
          metrics:
            - aggregation: average
              field: metrics.memcached.operation_hit_ratio
              label: Hit Ratio
              format:
                type: percent
      - title: Operations Breakdown
        position: {x: 24, y: 12}
        size: {w: 24, h: 10}
        lens:
          type: line
          data_view: metrics-*
          legend:
            visible: show
            position: right
          dimension:
            field: '@timestamp'
            type: date_histogram
          breakdown:
            field: attributes.operation
            type: values
            size: 10
          metrics:
            - formula: "counter_rate(max(metrics.memcached.operations, kql='attributes.type: hit'))"
              label: Hits/sec
            - formula: "counter_rate(max(metrics.memcached.operations, kql='attributes.type: miss'))"
              label: Misses/sec
      - title: Commands Executed
        position: {x: 0, y: 22}
        size: {w: 24, h: 10}
        lens:
          type: area
          mode: stacked
          data_view: metrics-*
          legend:
            visible: show
            position: right
          dimension:
            field: '@timestamp'
            type: date_histogram
          breakdown:
            field: attributes.command
            type: values
            size: 10
          metrics:
            - formula: counter_rate(max(metrics.memcached.commands))
              label: Commands/sec
      - title: CPU Usage
        position: {x: 24, y: 22}
        size: {w: 24, h: 10}
        lens:
          type: area
          mode: stacked
          data_view: metrics-*
          legend:
            visible: show
            position: right
          dimension:
            field: '@timestamp'
            type: date_histogram
          breakdown:
            field: attributes.state
            type: values
            size: 10
          metrics:
            - formula: counter_rate(max(metrics.memcached.cpu.usage))
              label: CPU Time (sec/sec)
      - title: Capacity & Health
        position: {x: 0, y: 32}
        size: {w: 48, h: 3}
        markdown:
          content: |
            ### Capacity & Health Metrics
            Storage, items, evictions, and connection metrics for capacity planning.
          font_size: 12
      - title: Items Over Time
        position: {x: 0, y: 35}
        size: {w: 24, h: 10}
        lens:
          type: line
          data_view: metrics-*
          legend:
            visible: hide
          dimension:
            field: '@timestamp'
            type: date_histogram
          metrics:
            - aggregation: average
              field: metrics.memcached.current_items
              label: Current Items
      - title: Storage Over Time
        position: {x: 24, y: 35}
        size: {w: 24, h: 10}
        lens:
          type: line
          data_view: metrics-*
          legend:
            visible: hide
          dimension:
            field: '@timestamp'
            type: date_histogram
          metrics:
            - aggregation: average
              field: metrics.memcached.bytes
              label: Bytes Used
              format:
                type: bytes
      - title: Evictions Rate
        position: {x: 0, y: 45}
        size: {w: 24, h: 10}
        lens:
          type: line
          data_view: metrics-*
          legend:
            visible: hide
          dimension:
            field: '@timestamp'
            type: date_histogram
          metrics:
            - formula: counter_rate(max(metrics.memcached.evictions))
              label: Evictions/sec
      - title: Current Connections
        position: {x: 24, y: 45}
        size: {w: 12, h: 10}
        lens:
          type: line
          data_view: metrics-*
          legend:
            visible: hide
          dimension:
            field: '@timestamp'
            type: date_histogram
          metrics:
            - aggregation: average
              field: metrics.memcached.connections.current
              label: Current Connections
      - title: New Connections Rate
        position: {x: 36, y: 45}
        size: {w: 12, h: 10}
        lens:
          type: line
          data_view: metrics-*
          legend:
            visible: hide
          dimension:
            field: '@timestamp'
            type: date_histogram
          metrics:
            - formula: counter_rate(max(metrics.memcached.connections.total))
              label: New Connections/sec
      - title: Network
        position: {x: 0, y: 55}
        size: {w: 48, h: 3}
        markdown:
          content: |
            ### Network Metrics
            Network traffic monitoring for sent and received bytes.
          font_size: 12
      - title: Network Traffic - Received
        position: {x: 0, y: 58}
        size: {w: 24, h: 10}
        lens:
          type: area
          mode: stacked
          data_view: metrics-*
          legend:
            visible: hide
          filters:
            - field: attributes.direction
              equals: received
          dimension:
            field: '@timestamp'
            type: date_histogram
          metrics:
            - formula: counter_rate(max(metrics.memcached.network))
              label: Received Bytes/sec
              format:
                type: bytes
      - title: Network Traffic - Sent
        position: {x: 24, y: 58}
        size: {w: 24, h: 10}
        lens:
          type: area
          mode: stacked
          data_view: metrics-*
          legend:
            visible: hide
          filters:
            - field: attributes.direction
              equals: sent
          dimension:
            field: '@timestamp'
            type: date_histogram
          metrics:
            - formula: counter_rate(max(metrics.memcached.network))
              label: Sent Bytes/sec
              format:
                type: bytes

---
# Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
# or more contributor license agreements. Licensed under the Elastic License 2.0;
# you may not use this file except in compliance with the Elastic License 2.0.
# See ../../licenses/ELASTIC-LICENSE-2.0.txt for the full license text.
#
# This file is derived from the Elastic integrations repository:
# https://github.com/elastic/integrations/tree/main/packages/system_otel
#
# Modified by kb-yaml-to-lens contributors to convert from Kibana JSON format
# to YAML format for use as documentation examples.
dashboards:
  - id: otel-host-details-logs
    name: '[OTel System] Host Details - Logs'
    description: Host log messages from OpenTelemetry logs collection
    filters:
      - exists: resource.attributes.host.name
    controls:
      - type: options
        label: Host Name
        data_view: logs-*
        field: resource.attributes.host.name
      - type: options
        label: Log Level
        data_view: logs-*
        field: log.level
    panels:
      # ═══════════════════════════════════════════════════════════════════════
      # NAVIGATION
      # ═══════════════════════════════════════════════════════════════════════
      - title: Navigation
        size: {w: 48, h: 3}
        links:
          layout: horizontal
          items:
            - label: Hosts Overview
              dashboard: otel-hosts-overview
            - label: Host Overview
              dashboard: otel-host-details-overview
            - label: Host Metrics
              dashboard: otel-host-details-metrics
            - label: Host Metadata
              dashboard: otel-host-details-metadata
            - label: Host Logs
              dashboard: otel-host-details-logs

      # ═══════════════════════════════════════════════════════════════════════
      # LOG SUMMARY
      # ═══════════════════════════════════════════════════════════════════════
      - title: Log Summary
        size: {w: 48, h: 2}
        markdown:
          content: '## Log Summary'
      - title: Log Events Over Time
        size: {w: 32, h: 12}
        lens:
          type: area
          mode: stacked
          data_view: logs-*
          dimension:
            field: '@timestamp'
            type: date_histogram
          breakdown:
            type: values
            field: log.level
            size: 10
          metrics:
            - aggregation: count
              label: Events
      - title: Log Level Distribution
        size: {w: 16, h: 12}
        lens:
          type: pie
          data_view: logs-*
          dimensions:
            - field: log.level
              type: values
              label: Level
              size: 10
          metrics:
            - aggregation: count
              label: Events

      # ═══════════════════════════════════════════════════════════════════════
      # LOG DETAILS TABLE
      # ═══════════════════════════════════════════════════════════════════════
      - title: Log Details
        size: {w: 48, h: 2}
        markdown:
          content: '## Log Details'
      - title: Logs
        size: {w: 48, h: 40}
        esql:
          type: datatable
          query:
            - FROM logs-*
            - WHERE resource.attributes.host.name IS NOT NULL
            - SORT @timestamp DESC
            - LIMIT 1000
            - KEEP @timestamp, log.level, log.logger, message
          dimensions:
            - field: '@timestamp'
            - field: log.level
            - field: log.logger
            - field: message

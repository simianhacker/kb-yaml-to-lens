---
dashboards:
  - id: crowdstrike-modern-assets-9c0d1e2f-3a4b-5c6d-7e8f-9a0b1c2d3e4f
    name: '[CrowdStrike Modern] Asset & Vulnerability Management'
    description: Comprehensive asset inventory and vulnerability tracking dashboard for risk assessment, patch prioritization, and security posture
      monitoring across the infrastructure.
    filters:
      - or:
          - field: data_stream.dataset
            equals: crowdstrike.host
          - field: data_stream.dataset
            equals: crowdstrike.vulnerability
    controls:
      - type: options
        label: Vulnerability Severity
        width: medium
        data_view: logs-*
        field: vulnerability.severity
        match_technique: exact
      - type: options
        label: Vulnerability Status
        width: medium
        data_view: logs-*
        field: crowdstrike.vulnerability.status
        match_technique: exact
      - type: options
        label: OS Platform
        width: small
        data_view: logs-*
        field: host.os.platform
        match_technique: exact
    panels:
      # Context Layer - Navigation
      - title: Dashboard Navigation
        size:
          w: 48
          h: 4
        links:
          layout: horizontal
          items:
            - label: SOC Dashboard
              dashboard: crowdstrike-modern-soc-7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d
            - label: Threat Investigation
              dashboard: crowdstrike-modern-investigation-8b9c0d1e-2f3a-4b5c-6d7e-8f9a0b1c2d3e
            - label: Asset & Vulnerability
              dashboard: crowdstrike-modern-assets-9c0d1e2f-3a4b-5c6d-7e8f-9a0b1c2d3e4f
            - label: Compliance & Audit
              dashboard: crowdstrike-modern-compliance-0d1e2f3a-4b5c-6d7e-8f9a-0b1c2d3e4f5a

      # Analysis Layer - Vulnerability Trend
      - title: Vulnerability Detections Over Time
        description: Time series showing vulnerability discovery and remediation trends
        size:
          w: 48
          h: 15
        lens:
          type: area
          data_view: logs-*
          dimension:
            field: '@timestamp'
            type: date_histogram
            label: Time
          breakdown:
            field: vulnerability.severity
            type: values
            size: 5
            sort:
              by: Vulnerability Count
              direction: desc
            other_bucket: false
            missing_bucket: false
          metrics:
            - aggregation: count
              label: Vulnerability Count
          filters:
            - field: data_stream.dataset
              equals: crowdstrike.vulnerability

      # Analysis Layer - Vulnerability Severity
      - title: Vulnerability by Severity
        description: Risk distribution showing critical, high, medium, and low severity vulnerabilities
        size:
          w: 12
          h: 15
        lens:
          type: pie
          data_view: logs-*
          appearance:
            donut: medium
          dimensions:
            - field: vulnerability.severity
              type: values
              size: 5
              sort:
                by: Count
                direction: desc
              other_bucket: false
              missing_bucket: false
          metrics:
            - aggregation: count
              label: Count
          filters:
            - field: data_stream.dataset
              equals: crowdstrike.vulnerability

      # Analysis Layer - Vulnerability Status
      - title: Vulnerability Status
        description: Current remediation status for patch management tracking
        size:
          w: 12
          h: 15
        lens:
          type: pie
          data_view: logs-*
          appearance:
            donut: medium
          dimensions:
            - field: crowdstrike.vulnerability.status
              type: values
              size: 8
              sort:
                by: Count
                direction: desc
              other_bucket: true
              missing_bucket: false
          metrics:
            - aggregation: count
              label: Count
          filters:
            - field: data_stream.dataset
              equals: crowdstrike.vulnerability

      # Analysis Layer - Vulnerability Confidence
      - title: Vulnerability Confidence
        description: Detection confidence levels for prioritization
        size:
          w: 12
          h: 15
        lens:
          type: pie
          data_view: logs-*
          appearance:
            donut: medium
          dimensions:
            - field: crowdstrike.vulnerability.confidence
              type: values
              size: 5
              sort:
                by: Count
                direction: desc
              other_bucket: false
              missing_bucket: false
          metrics:
            - aggregation: count
              label: Count
          filters:
            - field: data_stream.dataset
              equals: crowdstrike.vulnerability

      # Analysis Layer - OS Platform Distribution
      - title: Asset Platform Distribution
        description: Operating system platforms in the infrastructure
        size:
          w: 12
          h: 15
        lens:
          type: pie
          data_view: logs-*
          appearance:
            donut: medium
          dimensions:
            - field: host.os.platform
              type: values
              size: 8
              sort:
                by: Count
                direction: desc
              other_bucket: true
              missing_bucket: false
          metrics:
            - aggregation: count
              label: Count

      # Detail Layer - Top Vulnerabilities
      - title: Top 10 Critical Vulnerabilities (CVEs)
        description: Most prevalent critical vulnerabilities requiring immediate patching
        size:
          w: 24
          h: 15
        lens:
          type: bar
          data_view: logs-*
          dimension:
            field: vulnerability.id
            type: values
            size: 10
            sort:
              by: Occurrence Count
              direction: desc
            other_bucket: false
            missing_bucket: false
          metrics:
            - aggregation: count
              label: Occurrence Count
          filters:
            - field: data_stream.dataset
              equals: crowdstrike.vulnerability

      # Detail Layer - Most Vulnerable Hosts
      - title: Top 10 Most Vulnerable Hosts
        description: Assets with highest vulnerability count requiring remediation
        size:
          w: 24
          h: 15
        lens:
          type: bar
          data_view: logs-*
          dimension:
            field: host.name
            type: values
            size: 10
            sort:
              by: Vulnerability Count
              direction: desc
            other_bucket: false
            missing_bucket: false
          metrics:
            - aggregation: count
              label: Vulnerability Count
          filters:
            - field: data_stream.dataset
              equals: crowdstrike.vulnerability

      # Detail Layer - OS Versions
      - title: Top 10 Operating System Versions
        description: Full OS version details for asset inventory and patch planning
        size:
          w: 24
          h: 15
        lens:
          type: bar
          data_view: logs-*
          dimension:
            field: host.os.full
            type: values
            size: 10
            sort:
              by: Host Count
              direction: desc
            other_bucket: false
            missing_bucket: false
          metrics:
            - aggregation: count
              label: Host Count

      # Detail Layer - Host IPs
      - title: Top 10 Host IP Addresses
        description: Network addresses for asset tracking and network segmentation analysis
        size:
          w: 24
          h: 15
        lens:
          type: bar
          data_view: logs-*
          dimension:
            field: host.ip
            type: values
            size: 10
            sort:
              by: Record Count
              direction: desc
            other_bucket: false
            missing_bucket: false
          metrics:
            - aggregation: count
              label: Record Count
